#!/usr/bin/env bash

readonly ZSH_PLUGINS="$HOME/.zsh_plugs"
readonly FPATH_PLUGINS="/usr/local/share/zsh/site-functions"

readonly PURE_PROMPT_SYMBOL='λ'
readonly PURE_GIT_DOWN_ARROW='▼'
readonly PURE_GIT_UP_ARROW='▲'

_get_plugin_file() {
  (cd "$ZSH_PLUGINS"; curl -O "$1")
}

_clone_plugin() {
  (cd "$ZSH_PLUGINS"; git clone "$1")
}

plugins_install() {
  rm -rf "$ZSH_PLUGINS"
  mkdir "$ZSH_PLUGINS"

  _get_plugin_file https://raw.githubusercontent.com/rupa/z/master/z.sh

  _get_plugin_file https://raw.githubusercontent.com/sindresorhus/pure/master/pure.zsh
  ln -fns "$ZSH_PLUGINS"/pure.zsh "$FPATH_PLUGINS"/prompt_pure_setup
  _get_plugin_file https://raw.githubusercontent.com/sindresorhus/pure/master/async.zsh
  ln -fns "$ZSH_PLUGINS"/async.zsh "$FPATH_PLUGINS"/async

  _clone_plugin https://github.com/zsh-users/zsh-completions.git

  _clone_plugin https://github.com/zsh-users/zsh-syntax-highlighting.git
}

plugins_load() {
  fpath=($ZSH_PLUGINS/zsh-completions/src $fpath)
  autoload -Uz compinit; compinit
  autoload -Uz promptinit; promptinit
  prompt pure
  source "$ZSH_PLUGINS"/z.sh
  source "$ZSH_PLUGINS"/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
}
